<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éº—ã—ã®ã‚·ãƒ³ãƒ‡ãƒ¬ãƒ©ãƒ©ã‚¤ãƒ•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;700&display=swap');

        body {
            font-family: 'Shippori+Mincho', serif;
            background: linear-gradient(135deg, #fff5f7 0%, #fce4ec 100%);
            color: #4a4a4a;
        }

        .gold-border {
            border: 2px solid #d4af37;
        }

        .premium-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(212, 175, 55, 0.1);
        }

        .btn-action {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-action:active {
            transform: scale(0.95);
        }

        .progress-bar {
            transition: width 0.3s ease;
        }

        .tab-active {
            background-color: #d4af37;
            color: white;
        }

        @keyframes sparkle {
            0% {
                opacity: 0;
                transform: scale(0);
            }

            50% {
                opacity: 1;
                transform: scale(1.2);
            }

            100% {
                opacity: 0;
                transform: scale(0);
            }
        }

        .sparkle-el {
            position: absolute;
            pointer-events: none;
            animation: sparkle 0.8s ease-in-out forwards;
        }
    </style>
</head>

<body class="min-h-screen pb-24">

    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-pink-100 p-4 shadow-sm">
        <div class="max-w-2xl mx-auto">
            <div class="flex justify-between items-center mb-2">
                <div>
                    <h1 class="text-xl font-bold text-pink-600">ğŸ’ éº—ã—ã®ã‚·ãƒ³ãƒ‡ãƒ¬ãƒ©</h1>
                    <p class="text-xs text-pink-400">æ·‘å¥³ã®éšæ®µã‚’ç™»ã‚Šã¾ã—ã‚‡ã†</p>
                </div>
                <div class="text-right">
                    <p class="text-lg font-bold text-amber-600">ğŸ’° <span id="money">0</span>å††</p>
                </div>
            </div>

            <div class="space-y-1">
                <div class="flex justify-between text-xs font-bold">
                    <span>Lv.<span id="level">1</span> <span id="rank-name">è¦‹ç¿’ã„æ·‘å¥³</span></span>
                    <span>æ¬¡ã¾ã§: <span id="xp">0</span> / <span id="next-xp">100</span> XP</span>
                </div>
                <div class="w-full bg-pink-100 h-2 rounded-full overflow-hidden">
                    <div id="xp-bar" class="progress-bar bg-pink-500 h-full" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-2xl mx-auto p-4">

        <!-- ç¾åœ¨ã®çŠ¶æ³ -->
        <section class="premium-card p-6 mb-6 gold-border flex items-center gap-4">
            <div class="text-5xl" id="house-emoji">ğŸ›–</div>
            <div class="flex-1">
                <h2 class="text-sm font-bold text-gray-500">ç¾åœ¨ã®ä½ã¾ã„</h2>
                <p class="text-lg font-bold" id="house-name">å®Ÿå®¶ã®ç‰©ç½®</p>
                <div class="mt-2 text-sm">
                    <span class="text-pink-500 font-bold">å¤«: </span>
                    <span id="husband-name">ç‹¬èº«</span>
                </div>
            </div>
            <div id="passive-income"
                class="text-xs bg-pink-50 px-3 py-1 rounded-full border border-pink-200 text-pink-700">
                ãŠå°é£ã„: +0å††/ç§’
            </div>
        </section>

        <!-- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ -->
        <nav class="flex gap-2 mb-6">
            <button onclick="switchTab('work')" id="tab-work"
                class="flex-1 py-3 rounded-xl font-bold border-2 border-amber-500 text-amber-700 transition-all tab-active">ğŸ§¹
                å®¶äº‹</button>
            <button onclick="switchTab('marriage')" id="tab-marriage"
                class="flex-1 py-3 rounded-xl font-bold border-2 border-amber-500 text-amber-700 transition-all">ğŸ’
                çµå©š</button>
            <button onclick="switchTab('shop')" id="tab-shop"
                class="flex-1 py-3 rounded-xl font-bold border-2 border-amber-500 text-amber-700 transition-all">ğŸ›ï¸
                è²·ã„ç‰©</button>
        </nav>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ -->
        <div id="view-work" class="space-y-4">
            <div class="grid grid-cols-1 gap-4">
                <button onclick="doWork('cleaning')"
                    class="btn-action premium-card p-6 flex items-center justify-between hover:bg-white active:bg-pink-50 group border-2 border-transparent hover:border-pink-200">
                    <div class="flex items-center gap-4">
                        <span class="text-4xl group-hover:rotate-12 transition-transform">ğŸ§¹</span>
                        <div class="text-left">
                            <h3 class="font-bold">å¿µå…¥ã‚Šãªæƒé™¤</h3>
                            <p class="text-xs text-gray-500">XPã¨å°‘ã—ã®ãŠé‡‘ã‚’ç²å¾—</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-pink-600 font-bold">+5 XP</p>
                        <p class="text-amber-600 text-sm font-bold">+100å††</p>
                    </div>
                </button>

                <button onclick="doWork('cooking')"
                    class="btn-action premium-card p-6 flex items-center justify-between hover:bg-white active:bg-pink-50 group border-2 border-transparent hover:border-pink-200">
                    <div class="flex items-center gap-4">
                        <span class="text-4xl group-hover:rotate-12 transition-transform">ğŸ³</span>
                        <div class="text-left">
                            <h3 class="font-bold">å‡ã£ãŸå®¶åº­æ–™ç†</h3>
                            <p class="text-xs text-gray-500">å¥³å­åŠ›ã‚’é«˜ã‚ã‚‹</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-pink-600 font-bold">+12 XP</p>
                        <p class="text-amber-600 text-sm font-bold">+250å††</p>
                    </div>
                </button>

                <button onclick="doWork('etiquette')"
                    class="btn-action premium-card p-6 flex items-center justify-between hover:bg-white active:bg-pink-50 group border-2 border-transparent hover:border-pink-200">
                    <div class="flex items-center gap-4">
                        <span class="text-4xl group-hover:rotate-12 transition-transform">ğŸ’ƒ</span>
                        <div class="text-left">
                            <h3 class="font-bold">ãƒãƒŠãƒ¼ã®ç¿’å¾—</h3>
                            <p class="text-xs text-gray-500">XPã‚’å¤§å¹…ã«ç²å¾—</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-pink-600 font-bold">+30 XP</p>
                        <p class="text-amber-600 text-sm font-bold">+50å††</p>
                    </div>
                </button>
            </div>
        </div>

        <div id="view-marriage" class="hidden space-y-4">
            <h2 class="font-bold text-center text-pink-700">é‹å‘½ã®å‡ºä¼šã„</h2>
            <div id="husband-list" class="space-y-4">
                <!-- JSã§ç”Ÿæˆ -->
            </div>
        </div>

        <div id="view-shop" class="hidden space-y-6">
            <div>
                <h2 class="font-bold text-pink-700 mb-3">ğŸ¡ ä¸å‹•ç”£ï¼ˆãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—åŠ¹ç‡UPï¼‰</h2>
                <div id="house-list" class="space-y-3">
                    <!-- JSã§ç”Ÿæˆ -->
                </div>
            </div>
            <div>
                <h2 class="font-bold text-pink-700 mb-3">ğŸ’ ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ãƒ»ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</h2>
                <div id="accessory-list" class="grid grid-cols-2 gap-3">
                    <!-- JSã§ç”Ÿæˆ -->
                </div>
            </div>
        </div>

    </main>

    <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€šçŸ¥ -->
    <div id="toast"
        class="fixed bottom-28 left-1/2 -translate-x-1/2 z-50 pointer-events-none opacity-0 transition-opacity">
        <div class="bg-gray-800/90 text-white px-6 py-2 rounded-full shadow-lg text-sm" id="toast-text"></div>
    </div>

    <script>
        // ã‚²ãƒ¼ãƒ è¨­å®šãƒ‡ãƒ¼ã‚¿
        const HUSBANDS = [
            { id: 0, name: "ç‹¬èº«", req: 0, income: 0, emoji: "ğŸ‘¤" },
            { id: 1, name: "è¿‘æ‰€ã®å„ªã—ã„é’å¹´", req: 2, income: 50, emoji: "ğŸ§’" },
            { id: 2, name: "åœ°å…ƒã®ä¸­å …ä¼æ¥­ç¤¾å“¡", req: 5, income: 200, emoji: "ğŸ‘”" },
            { id: 3, name: "ã‚„ã‚Šæ‰‹ã®è‹¥æ‰‹èµ·æ¥­å®¶", req: 10, income: 1000, emoji: "ğŸ•¶ï¸" },
            { id: 4, name: "ä»£ã€…ç¶šãåå®¶ã®å­æ¯", req: 20, income: 5000, emoji: "ğŸ¤µ" },
            { id: 5, name: "ã‚«ãƒªã‚¹ãƒITé•·è€…", req: 35, income: 20000, emoji: "ğŸ“±" },
            { id: 6, name: "ã‚¢ãƒ©ãƒ–ã®çŸ³æ²¹ç‹", req: 50, income: 100000, emoji: "ğŸ‘³" },
            { id: 7, name: "ä¼èª¬ã®å›½ã®ç‹å­æ§˜", req: 80, income: 1000000, emoji: "ğŸ¤´" }
        ];

        const HOUSES = [
            { id: 1, name: "å®Ÿå®¶ã®ç‰©ç½®", price: 0, xpMult: 1, emoji: "ğŸ›–" },
            { id: 2, name: "é§…è¿‘1Kã‚¢ãƒ‘ãƒ¼ãƒˆ", price: 50000, xpMult: 1.2, emoji: "ğŸ¢" },
            { id: 3, name: "æ–°ç¯‰ã‚¿ãƒ¯ãƒ¼ãƒãƒ³ã‚·ãƒ§ãƒ³", price: 2000000, xpMult: 2, emoji: "ğŸ™ï¸" },
            { id: 4, name: "éƒ½å†…ã®ä¸€ç­‰åœ°è±ªé‚¸", price: 50000000, xpMult: 5, emoji: "ğŸ " },
            { id: 5, name: "æ¹–ç•”ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆå®®æ®¿", price: 1000000000, xpMult: 10, emoji: "ğŸ°" }
        ];

        const ACCESSORIES = [
            { id: 1, name: "ãƒ‘ãƒ¼ãƒ«ã®ãƒ”ã‚¢ã‚¹", price: 10000, emoji: "ğŸ‘‚" },
            { id: 2, name: "ç´”é‡‘ã®ãƒãƒƒã‚¯ãƒ¬ã‚¹", price: 50000, emoji: "ğŸ“¿" },
            { id: 3, name: "ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰ã®ãƒãƒƒã‚°", price: 300000, emoji: "ğŸ‘œ" },
            { id: 4, name: "æœ€é«˜ç´šã®æ¯›çš®ã‚³ãƒ¼ãƒˆ", price: 1500000, emoji: "ğŸ§¥" },
            { id: 5, name: "ä¼èª¬ã®ãƒ†ã‚£ã‚¢ãƒ©", price: 10000000, emoji: "ğŸ‘‘" }
        ];

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
        let state = {
            money: 0,
            xp: 0,
            level: 1,
            husbandId: 0,
            houseId: 1,
            myAccessories: [], // IDã®é…åˆ—
            lastTick: Date.now()
        };

        // åˆæœŸåŒ–
        window.onload = () => {
            loadGame();
            updateUI();
            setInterval(gameLoop, 1000);
        };

        function getNextXP(lv) {
            return Math.floor(100 * Math.pow(1.5, lv - 1));
        }

        function getRankName(lv) {
            if (lv < 5) return "è¦‹ç¿’ã„æ·‘å¥³";
            if (lv < 10) return "å¯æ†ãªä¹™å¥³";
            if (lv < 20) return "éƒ½ä¼šã®è¯";
            if (lv < 40) return "ç¤¾äº¤ç•Œã®æ†§ã‚Œ";
            if (lv < 60) return "æ°—é«˜ãå…¬çˆµå¤«äºº";
            return "æ°¸é ã®ãƒ—ãƒªãƒ³ã‚»ã‚¹";
        }

        function doWork(type) {
            const house = HOUSES.find(h => h.id === state.houseId);
            let gainXP = 0;
            let gainMoney = 0;

            if (type === 'cleaning') { gainXP = 5; gainMoney = 100; }
            if (type === 'cooking') { gainXP = 12; gainMoney = 250; }
            if (type === 'etiquette') { gainXP = 30; gainMoney = 50; }

            state.xp += gainXP * house.xpMult;
            state.money += gainMoney;

            checkLevelUp();
            updateUI();
            createSparkle(event.clientX, event.clientY);
        }

        function checkLevelUp() {
            let next = getNextXP(state.level);
            while (state.xp >= next) {
                state.xp -= next;
                state.level++;
                next = getNextXP(state.level);
                showToast(`ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼ Lv.${state.level} ã«ãªã‚Šã¾ã—ãŸâœ¨`);
            }
        }

        function gameLoop() {
            const husband = HUSBANDS.find(h => h.id === state.husbandId);
            if (husband.income > 0) {
                state.money += husband.income;
                updateUI();
            }
        }

        function switchTab(tab) {
            ['work', 'marriage', 'shop'].forEach(t => {
                document.getElementById(`view-${t}`).classList.add('hidden');
                document.getElementById(`tab-${t}`).classList.remove('tab-active');
            });
            document.getElementById(`view-${tab}`).classList.remove('hidden');
            document.getElementById(`tab-${tab}`).classList.add('tab-active');

            if (tab === 'marriage') renderMarriage();
            if (tab === 'shop') renderShop();
        }

        function renderMarriage() {
            const container = document.getElementById('husband-list');
            container.innerHTML = '';

            HUSBANDS.forEach(h => {
                if (h.id === 0) return;
                const isCurrent = state.husbandId === h.id;
                const isUnlocked = state.level >= h.req;

                const card = document.createElement('div');
                card.className = `premium-card p-4 flex items-center justify-between border-2 ${isCurrent ? 'border-pink-500 bg-pink-50' : 'border-transparent'}`;

                card.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-4xl ${isUnlocked ? '' : 'filter grayscale opacity-30'}">${h.emoji}</span>
                        <div>
                            <p class="font-bold ${isUnlocked ? '' : 'text-gray-400'}">${isUnlocked ? h.name : '???'}</p>
                            <p class="text-xs text-pink-600">ãŠå°é£ã„: +${h.income.toLocaleString()}å††/ç§’</p>
                            <p class="text-[10px] text-gray-400">å¿…è¦ãƒ¬ãƒ™ãƒ«: Lv.${h.req}</p>
                        </div>
                    </div>
                    <div>
                        ${isCurrent ?
                        '<span class="text-xs font-bold text-pink-500">æˆå©šä¸­ğŸ’</span>' :
                        (isUnlocked ?
                            `<button onclick="marry(${h.id})" class="bg-pink-500 text-white px-4 py-1 rounded-full text-sm font-bold shadow-md hover:bg-pink-600">çµå©šã™ã‚‹</button>` :
                            '<span class="text-xs text-gray-400">ãƒ¬ãƒ™ãƒ«ä¸è¶³</span>'
                        )
                    }
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function marry(id) {
            const h = HUSBANDS.find(hus => hus.id === id);
            state.husbandId = id;
            showToast(`${h.name}æ§˜ã¨ã”æˆå©šã•ã‚Œã¾ã—ãŸï¼ğŸ’âœ¨`);
            updateUI();
            renderMarriage();
        }

        function renderShop() {
            // ä½ã¾ã„ãƒªã‚¹ãƒˆ
            const hContainer = document.getElementById('house-list');
            hContainer.innerHTML = '';
            HOUSES.forEach(h => {
                const isOwned = state.houseId === h.id;
                const canAfford = state.money >= h.price;
                const alreadyBetter = state.houseId > h.id;

                const card = document.createElement('div');
                card.className = `premium-card p-4 flex items-center justify-between ${isOwned ? 'bg-amber-50 border border-amber-300' : ''}`;
                card.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-3xl">${h.emoji}</span>
                        <div>
                            <p class="font-bold text-sm">${h.name}</p>
                            <p class="text-[10px] text-amber-600">XPç²å¾—é‡: x${h.xpMult}</p>
                        </div>
                    </div>
                    <div>
                        ${isOwned ?
                        '<span class="text-xs font-bold text-amber-600">ç¾åœ¨ã®ä½ã¾ã„</span>' :
                        (alreadyBetter ? '-' : `<button onclick="buyHouse(${h.id})" class="${canAfford ? 'bg-amber-500' : 'bg-gray-300'} text-white px-3 py-1 rounded-lg text-xs font-bold">${h.price.toLocaleString()}å††</button>`)
                    }
                    </div>
                `;
                hContainer.appendChild(card);
            });

            // ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ãƒªã‚¹ãƒˆ
            const aContainer = document.getElementById('accessory-list');
            aContainer.innerHTML = '';
            ACCESSORIES.forEach(a => {
                const isOwned = state.myAccessories.includes(a.id);
                const canAfford = state.money >= a.price;

                const card = document.createElement('div');
                card.className = `premium-card p-3 text-center flex flex-col items-center gap-1 ${isOwned ? 'bg-pink-50 border border-pink-200' : ''}`;
                card.innerHTML = `
                    <span class="text-3xl mb-1">${a.emoji}</span>
                    <p class="text-[10px] font-bold h-8 flex items-center">${a.name}</p>
                    <div class="mt-auto w-full">
                        ${isOwned ?
                        '<span class="text-[10px] text-pink-500 font-bold">æ‰€æœ‰æ¸ˆã¿</span>' :
                        `<button onclick="buyAccessory(${a.id})" class="w-full ${canAfford ? 'bg-pink-400' : 'bg-gray-300'} text-white py-1 rounded text-[10px] font-bold">${a.price.toLocaleString()}å††</button>`
                    }
                    </div>
                `;
                aContainer.appendChild(card);
            });
        }

        function buyHouse(id) {
            const h = HOUSES.find(house => house.id === id);
            if (state.money >= h.price) {
                state.money -= h.price;
                state.houseId = id;
                showToast(`æ–°ã—ã„ãŠå®¶ã€Œ${h.name}ã€ã«ãŠå¼•è¶Šã—ã—ã¾ã—ãŸï¼ğŸ `);
                updateUI();
                renderShop();
            }
        }

        function buyAccessory(id) {
            const a = ACCESSORIES.find(acc => acc.id === id);
            if (state.money >= a.price) {
                state.money -= a.price;
                state.myAccessories.push(id);
                showToast(`${a.name}ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ãŸï¼ğŸ’`);
                updateUI();
                renderShop();
            }
        }

        function updateUI() {
            document.getElementById('money').innerText = Math.floor(state.money).toLocaleString();
            document.getElementById('level').innerText = state.level;
            document.getElementById('xp').innerText = Math.floor(state.xp);
            const next = getNextXP(state.level);
            document.getElementById('next-xp').innerText = next;
            document.getElementById('rank-name').innerText = getRankName(state.level);
            document.getElementById('xp-bar').style.width = `${(state.xp / next) * 100}%`;

            const husband = HUSBANDS.find(h => h.id === state.husbandId);
            document.getElementById('husband-name').innerText = husband.name;
            document.getElementById('passive-income').innerText = `ãŠå°é£ã„: +${husband.income.toLocaleString()}å††/ç§’`;

            const house = HOUSES.find(h => h.id === state.houseId);
            document.getElementById('house-name').innerText = house.name;
            document.getElementById('house-emoji').innerText = house.emoji;

            saveGame();
        }

        function showToast(text) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-text').innerText = text;
            toast.classList.remove('opacity-0');
            setTimeout(() => toast.classList.add('opacity-0'), 3000);
        }

        function createSparkle(x, y) {
            for (let i = 0; i < 5; i++) {
                const s = document.createElement('div');
                s.className = 'sparkle-el';
                s.innerHTML = 'âœ¨';
                s.style.left = `${x + (Math.random() - 0.5) * 60}px`;
                s.style.top = `${y + (Math.random() - 0.5) * 60}px`;
                s.style.fontSize = `${10 + Math.random() * 15}px`;
                document.body.appendChild(s);
                setTimeout(() => s.remove(), 800);
            }
        }

        function saveGame() {
            localStorage.setItem('cinderella_save', JSON.stringify(state));
        }

        function loadGame() {
            const saved = localStorage.getItem('cinderella_save');
            if (saved) {
                const parsed = JSON.parse(saved);
                state = { ...state, ...parsed };
            }
        }
    </script>
</body>

</html>